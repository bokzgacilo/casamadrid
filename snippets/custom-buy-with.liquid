{% assign all_products = collections['mujer-bestsellers'].products %}
{% assign sorted_products = all_products | sort: 'title' %} {# simulate "random" #}

<div class="buy-with-container">
  <div class="buy-with-header">
    <h3>Buy With</h3>
    <button id="carousel-prev">Prev</button>
    <button id="carousel-next">Next</button>
  </div>
  <div class="buy-with-products">
    {% for product in sorted_products %}
      {% render 'product-grid-item'
        , product: product %}
    {% endfor %}
  </div>
</div>

<style>
  .buy-with-container {
    display: flex;
    flex-direction: column;
  }

  .slick-track > .grid__item {
    padding: 5px !important;
    margin-bottom: 0;
  }

  .buy-with-header {
    display: flex;
    flex-direction: row;
    align-items: center;
  }

  .buy-with-product {
    padding: 10px;
    display: flex;
  }

  .buy-with-product > p {
    font-size: 12px;
    text-align: center;
    margin-top: 10px;
  }

  .buy-with-header > h3 {
    margin-right: auto;
    margin-bottom: 0;
  }
</style>

<script>
  const $carousel = $('.buy-with-products');
  
  $('.buy-with-products').slick({
    infinite: false,
    slidesToShow: 3,
    slidesToScroll: 3,
    arrows: true,
    responsive: [
      {
        breakpoint: 768, // screen width under 768px
        settings: {
          slidesToShow: 2,
          slidesToScroll: 2
        }
      }
    ]
  });
  
  $('#carousel-prev').on('click', function () {
    $carousel.slick('slickPrev');
  });
  
  $('#carousel-next').on('click', function () {
    $carousel.slick('slickNext');
  });
</script>