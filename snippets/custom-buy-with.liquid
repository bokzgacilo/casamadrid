{% comment %}
  Snippet: product-card.liquid
  Description: Displays a single product card with image, title, price, and optional rating placeholder.
  Usage:
    This snippet is designed to be rendered from a section that uses a 'product_display' block type.
    It expects a 'block' object to be passed, which contains the product settings.

    Example in a section:
    {% for block in section.blocks %}
      {% if block.type == 'product_display' %}
        {% render 'product-card', block: block %}
      {% endif %}
    {% endfor %}
{% endcomment %}

{% assign product = block.settings.product %}
{% assign show_ratings_placeholder = block.settings.show_ratings_placeholder %}

{% if product %}
  <div class="product-card-item" {{ block.shopify_attributes }}>
    <a href="{{ product.url | within: collection }}" class="product-card-link">
      <div class="product-card-image-wrapper">
        {% if product.featured_image %}
          <img
            src="{{ product.featured_image | image_url: width: 400 }}"
            alt="{{ product.featured_image.alt | escape }}"
            loading="lazy"
            class="product-card-image"
          >
        {% else %}
          <div class="product-card-image-placeholder">
            <svg aria-labelledby="no-image-title" role="img" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg"><title id="no-image-title">No image available</title><path d="M45 45H0V0h45v45zM15 8l10 10 5-5 15 15V8zM0 38l10-10 5 5 15-15 5 5v15H0z"></path></svg>
          </div>
        {% endif %}
        <div class="product-card-add-to-cart-icon">
          <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-bag" viewBox="0 0 20 20"><path fill="currentColor" d="M17 5h-3V3a3 3 0 00-3-3H9a3 3 0 00-3 3v2H3a3 3 0 00-3 3v9a3 3 0 003 3h14a3 3 0 003-3V8a3 3 0 00-3-3zM8 3a1 1 0 011-1h2a1 1 0 011 1v2H8V3zm10 14a1 1 0 01-1 1H3a1 1 0 01-1-1V8a1 1 0 011-1h14a1 1 0 011 1v9z"/></svg>
        </div>
      </div>
      <div class="product-card-details">
        {% if show_ratings_placeholder %}
          <div class="product-card-rating-placeholder">
            <span class="star-icon">★</span><span class="star-icon">★</span><span class="star-icon">★</span><span class="star-icon">★</span><span class="star-icon">☆</span> (4.0)
          </div>
        {% endif %}
        <h3 class="product-card-title">{{ product.title }}</h3>
        <div class="product-card-price-wrapper">
          {% if product.compare_at_price > product.price %}
            <span class="product-card-original-price">{{ product.compare_at_price | money }}</span>
            <span class="product-card-sale-price">{{ product.price | money }}</span>
          {% else %}
            <span class="product-card-current-price">{{ product.price | money }}</span>
          {% endif %}
        </div>
      </div>
    </a>
  </div>
{% endif %}

<style>
  /* Styles for the individual product card snippet */
  .product-card-item {
    padding: 1rem;
    box-sizing: border-box;
    text-align: center;
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transition: transform 0.2s ease-in-out;
  }

  .product-card-item:hover {
    transform: translateY(-5px);
  }

  .product-card-link {
    text-decoration: none;
    color: inherit;
    display: block;
  }

  .product-card-image-wrapper {
    position: relative;
    padding-bottom: 100%; /* Aspect ratio 1:1 */
    height: 0;
    overflow: hidden;
    border-radius: 8px;
    margin-bottom: 1rem;
    background-color: #f0f0f0; /* Placeholder background */
  }

  .product-card-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain; /* Ensure image fits without cropping */
  }

  .product-card-image-placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f0f0f0;
  }

  .product-card-image-placeholder svg {
    width: 60px;
    height: 60px;
    fill: #ccc;
  }

  .product-card-add-to-cart-icon {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .product-card-item:hover .product-card-add-to-cart-icon {
    opacity: 1;
    transform: translateY(0);
  }

  .product-card-add-to-cart-icon svg {
    width: 20px;
    height: 20px;
  }

  .product-card-details {
    padding: 0.5rem 0;
  }

  .product-card-rating-placeholder {
    font-size: 0.95rem;
    color: #ffc107; /* Gold color for stars */
    margin-bottom: 0.5rem;
  }

  .product-card-rating-placeholder .star-icon {
    margin-right: 1px;
  }

  .product-card-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .product-card-price-wrapper {
    font-size: 1rem;
    font-weight: bold;
    color: #007bff;
    display: flex;
    justify-content: center;
    align-items: baseline;
    gap: 0.5rem;
  }

  .product-card-original-price {
    color: #888;
    text-decoration: line-through;
    font-weight: normal;
    font-size: 0.9em;
  }

  .product-card-sale-price {
    color: #e60000; /* Red for sale price */
  }
</style>
