{% assign all_products = collections['mujer-bestsellers'].products %}
{% assign sorted_products = all_products | sort: 'title' %}

<div class="buy-with-container">
  <div class="buy-with-header">
    <h3>Buy With</h3>
    <button id="carousel-prev"><svg role="presentation" focusable="false" width="5" height="8" class="icon icon-chevron-left-small reverse-icon" viewBox="0 0 5 8">
        <path d="m4.25 7-3-3 3-3" fill="none" stroke="currentColor" stroke-width="1.5"></path>
      </svg></button>
    <button id="carousel-next"><svg role="presentation" focusable="false" width="5" height="8" class="icon icon-chevron-right-small reverse-icon" viewBox="0 0 5 8">
        <path d="m.75 7 3-3-3-3" fill="none" stroke="currentColor" stroke-width="1.5"></path>
      </svg></button>
  </div>
  <div class="buy-with-products">
    {% for product in sorted_products limit: 8 %}
      {% render 'product-grid-item'
        , product: product %}
    {% endfor %}
  </div>
</div>

<style>
  .buy-with-header button svg {
    margin-top: -3px;
}
  .buy-with-header button {
    background: black;
    margin-right: 3px;
    border-radius: 30px;
    height: 30px;
    width: 30px;
    color: white;
}
  #carousel-prev  path {
    d: path("m 4.25 7 l -3 -3 l 3 -3");
    fill: none;
    stroke: currentcolor;
    stroke-width: 0.5;
}
    #carousel-next  path {
       d: path("m 0.75 7 l 3 -3 l -3 -3");
    fill: none;
    stroke: currentcolor;
    stroke-width: 0.5;
}
  .buy-with-container {
    display: flex;
    flex-direction: column;
  }

  .slick-track > .grid__item {
    padding: 5px !important;
    margin-bottom: 0;
  }

  .buy-with-header {
    display: flex;
    flex-direction: row;
        margin-bottom: 20px;
    align-items: center;
  }

  .buy-with-product {
    padding: 10px;
    display: flex;
  }

  .buy-with-product > p {
    font-size: 12px;
    text-align: center;
    margin-top: 10px;
  }

  .buy-with-header > h3 {
    margin-right: auto;
    margin-bottom: 0;
  }
</style>

<script>
  const $carousel = $('.buy-with-products');
  
  $('.buy-with-products').slick({
    infinite: false,
    slidesToShow: 3,
    slidesToScroll: 3,
    arrows: true,
    responsive: [
      {
        breakpoint: 768, // screen width under 768px
        settings: {
          slidesToShow: 2,
          slidesToScroll: 2
        }
      }
    ]
  });
  
  $('#carousel-prev').on('click', function () {
    $carousel.slick('slickPrev');
  });
  
  $('#carousel-next').on('click', function () {
    $carousel.slick('slickNext');
  });
</script>